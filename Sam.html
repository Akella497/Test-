<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Самоцветы</title>

<style>
html, body {
  margin: 0;
  width: 100%;
  height: 100%;
  overflow: hidden;
}

#viewport {
  position: relative;
  width: 100%;
  height: 100%;
  background: #000;
  overflow: hidden;
  cursor: grab;
}

#map {
  position: absolute;
  top: 0;
  left: 0;
  user-select: none;
  pointer-events: none;
  transform-origin: top left;
}
</style>
</head>

<body>

<div id="viewport">
  <img
    id="map"
    src="https://cdn.imgpile.com/f/czYW80F_xl.jpg"
    draggable="false"
  >
</div>

<script>
const viewport = document.getElementById("viewport");
const map = document.getElementById("map");

let isDragging = false;
let startX = 0, startY = 0;
let translateX = 0, translateY = 0;
let scale = 1;

function clamp(value, min, max) {
  return Math.min(Math.max(value, min), max);
}

function updateTransform() {
  map.style.transform = `translate(${translateX}px, ${translateY}px) scale(${scale})`;
}

map.onload = () => {
  const vw = viewport.clientWidth;
  const vh = viewport.clientHeight;

  const iw = map.naturalWidth;
  const ih = map.naturalHeight;

  // Масштаб: чтобы карта влезла по меньшей стороне
  scale = Math.max(vw / iw, vh / ih);

  const scaledWidth = iw * scale;
  const scaledHeight = ih * scale;

  // Центрирование
  translateX = (vw - scaledWidth) / 2;
  translateY = (vh - scaledHeight) / 2;

  updateTransform();
};

viewport.addEventListener("mousedown", (e) => {
  isDragging = true;
  viewport.style.cursor = "grabbing";
  startX = e.clientX;
  startY = e.clientY;
});

window.addEventListener("mouseup", () => {
  isDragging = false;
  viewport.style.cursor = "grab";
});

window.addEventListener("mousemove", (e) => {
  if (!isDragging) return;

  const dx = e.clientX - startX;
  const dy = e.clientY - startY;

  startX = e.clientX;
  startY = e.clientY;

  const vw = viewport.clientWidth;
  const vh = viewport.clientHeight;

  const mapWidth = map.naturalWidth * scale;
  const mapHeight = map.naturalHeight * scale;

  translateX += dx;
  translateY += dy;

  // Ограничения
  const minX = vw - mapWidth;
  const minY = vh - mapHeight;

  translateX = clamp(translateX, minX, 0);
  translateY = clamp(translateY, minY, 0);

  updateTransform();
});
</script>

</body>
</html>
